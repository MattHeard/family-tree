<!DOCYPE html>
<script src="d3.js" charset="utf-8"></script>
<script>
  function getPeople(data) {
    return data[0]["values"];
  }

  function getRelationships(data) {
    return data[1]["values"];
  }

  function getSpacing() {
    return 80;
  }

  function drawRelationships(data) {
    var spacing = getSpacing();
    var people = getPeople(data);
    var relationships = getRelationships(data);

    d3.select("svg")
      .selectAll("line")
        .data(relationships)
      .enter()
        .append("line")
        .attr("x1", function(d) { return people[d.from].x * spacing; })
        .attr("y1", function(d) { return people[d.from].y * spacing; })
        .attr("x2", function(d) { return people[d.to].x * spacing; })
        .attr("y2", function(d) { return people[d.to].y * spacing; });
  }

  function addPeople(people) {
    d3.select("svg")
      .selectAll("g")
        .data(people)
      .enter()
        .append("g");
  }

  function click(person_id) {
    console.log(person_id);
  }

  function drawCircles() {
    var spacing = getSpacing();

    d3.select("svg")
      .selectAll("g")
        .append("circle")
        .attr("r", 25)
        .attr("cx", function(d) { return d.x * spacing; })
        .attr("cy", function(d) { return d.y * spacing; })
        .attr("onclick", function(d, i) { return "click(" + i + ");"; });
  }

  function drawTooltips() {
    d3.select("svg")
      .selectAll("g")
      .select("circle")
        .append("title")
        .text(function(d) { return d.name; });
  }

  function drawPeople(data) {
    var people = getPeople(data);
    addPeople(people);
    drawCircles();
    drawTooltips();
  }

  d3.json("data.json", function(error, data) {
    drawRelationships(data);
    drawPeople(data);
  });
</script>
<style>
  body {
    margin: 0px;
  }

  svg {
    width: 800px;
    height: 600px;
  }

  line {
    stroke: rgb(6,120,155);
  }

  circle {
    fill: LightSalmon;
  }
</style>
<body>
  <svg></svg>
</body>
